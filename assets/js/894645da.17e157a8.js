"use strict";(self.webpackChunkgcp_workshop=self.webpackChunkgcp_workshop||[]).push([[355],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),s=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):p(p({},t),e)),a},c=function(e){var t=s(e.components);return n.createElement(l.Provider,{value:t},e.children)},h="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),h=s(a),u=i,m=h["".concat(l,".").concat(u)]||h[u]||g[u]||r;return a?n.createElement(m,p(p({ref:t},c),{},{components:a})):n.createElement(m,p({ref:t},c))}));function m(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,p=new Array(r);p[0]=u;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[h]="string"==typeof e?e:i,p[1]=o;for(var s=2;s<r;s++)p[s]=a[s];return n.createElement.apply(null,p)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},5145:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>p,metadata:()=>l,toc:()=>c});var n=a(7462),i=(a(7294),a(3905)),r=a(4996);const p={sidebar_position:2},o="Consume the API in a Web App",l={unversionedId:"app-services/app-graphql",id:"app-services/app-graphql",title:"Consume the API in a Web App",description:"Data services are only practical if you use them in an actual application. Let\u2019s do that! In this section, we\u2019ll connect an Angular web application to the App Services GraphQL API we created.",source:"@site/docs/3-app-services/app-graphql.mdx",sourceDirName:"3-app-services",slug:"/app-services/app-graphql",permalink:"/docs/app-services/app-graphql",draft:!1,editUrl:"https://github.com/mongodb-developer/google-cloud-workshop/blob/main/docs/3-app-services/app-graphql.mdx",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Create an Atlas GraphQL API",permalink:"/docs/app-services/create-app-services-app"},next:{title:"Google Cloud Natural Language API",permalink:"/docs/category/google-cloud-natural-language-api"}},s={},c=[{value:"Run the application in StackBlitz",id:"run-the-application-in-stackblitz",level:2},{value:"App Services authentication credentials",id:"app-services-authentication-credentials",level:2}],h={toc:c},g="wrapper";function u(e){let{components:t,...a}=e;return(0,i.kt)(g,(0,n.Z)({},h,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"consume-the-api-in-a-web-app"},"Consume the API in a Web App"),(0,i.kt)("p",null,"Data services are only practical if you use them in an actual application. Let\u2019s do that! In this section, we\u2019ll connect an Angular web application to the App Services GraphQL API we created. "),(0,i.kt)("h2",{id:"run-the-application-in-stackblitz"},"Run the application in StackBlitz"),(0,i.kt)("p",null,"We'll use StackBlitz, an online IDE, to run the application."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open the ",(0,i.kt)("a",{parentName:"p",href:"https://stackblitz.com/edit/mongodb-atlas-bakery?file=src/environments/environment.ts"},"StackBlitz project"),".")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Wait until the message ",(0,i.kt)("inlineCode",{parentName:"p"},"Compiling application & starting dev server\u2026")," is gone. "),(0,i.kt)("img",{alt:"StackBlitz editor highlighting the 'Compiling application & starting dev server\u2026' message",src:(0,r.Z)("/img/chapter-2-app-services/stackblitz-loading.png"),width:"400"})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Fork the project so you can make changes to it."),(0,i.kt)("img",{alt:"StackBlitz editor highlighting the 'Fork' button",src:(0,r.Z)("/img/chapter-2-app-services/stackblitz-fork.png"),width:"700"}))),(0,i.kt)("p",null,"In the code editor, you can see the open ",(0,i.kt)("inlineCode",{parentName:"p"},"environment.ts")," file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export const environment = {\n production: true,\n APP_ID: '',\n GRAPHQL_URI: '',\n API_KEY: ''\n};\n")),(0,i.kt)("p",null,"We will add our own credentials to this file. Let\u2019s get them from Atlas App Services."),(0,i.kt)("h2",{id:"app-services-authentication-credentials"},"App Services authentication credentials"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Open ",(0,i.kt)("a",{parentName:"p",href:"https://cloud.mongodb.com"},"MongoDB Atlas")," in a new tab in your browser and navigate to the App Services tab."),(0,i.kt)("img",{alt:"Atlas navigation bar highlighting the 'App Services' tab",src:(0,r.Z)("/img/chapter-2-app-services/app-services-tab.png")})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Select the application you created in the previous section."),(0,i.kt)("img",{alt:"App services applications highlighting the 'Bakery' app",src:(0,r.Z)("/img/chapter-2-app-services/app-services-apps.png")})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Copy your ",(0,i.kt)("strong",{parentName:"p"},"App ID")," and add it to the environment file."),(0,i.kt)("img",{alt:"App services page highlighting the 'App ID' copy button",src:(0,r.Z)("/img/chapter-2-app-services/bakery-app-id.png")})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Navigate to the GraphQL section, copy the ",(0,i.kt)("strong",{parentName:"p"},"GraphQL endpoint"),", and add it to the environment file."),(0,i.kt)("img",{alt:"App Services left-hand menu highlighting the 'GraphQL' section",src:(0,r.Z)("/img/chapter-2-app-services/graphql-tab.png"),width:"200"}),(0,i.kt)("img",{alt:"GraphQL page in App Services highlighting the 'Copy' button next to the GraphQL endpoint",src:(0,r.Z)("/img/chapter-2-app-services/graphql-endpoint.png")})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"To generate an API key, navigate to the ",(0,i.kt)("strong",{parentName:"p"},"Authentication")," section."),(0,i.kt)("img",{alt:"App Services left-hand menu highlighting the 'Authentication' section",src:(0,r.Z)("/img/chapter-2-app-services/authentication-tab.png"),width:"200"})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"There are a set of providers available for App Services. For this application, we\u2019ll use the ",(0,i.kt)("strong",{parentName:"p"},"API Keys")," provider. Select it from the list, and switch it on. Before generating the key, make sure to deploy the draft."),(0,i.kt)("img",{alt:"Authentication providers list highlighting the 'Edit' button on the 'API Keys' line",src:(0,r.Z)("/img/chapter-2-app-services/auth-providers.png"),width:"500"}),(0,i.kt)("img",{alt:"Authentication section with the 'On' toggle button highlighted",src:(0,r.Z)("/img/chapter-2-app-services/api-keys-provider.png"),width:"500"}),(0,i.kt)("img",{alt:"Review draft and deploy button",src:(0,r.Z)("/img/chapter-2-app-services/review-draft-and-deploy.png"),width:"500"})),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Generate a key, copy the value, and\u2014you guessed it\u2014add it to the environment file. ")),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Finally, your environment file should look something like this:"),(0,i.kt)("pre",{parentName:"li"},(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"export const environment = {\n    production: false,\n    APP_ID: 'bakery-lvtjx',\n    GRAPHQL_URI: 'https://realm.mongodb.com/api/client/v2.0/app/bakery-lvtjx/graphql',\n    API_KEY: 'RaOyilaiveCXYkNq30iHKq8LDj6kg71FvviTWJauTU5S9Il5zF0ONeDvWkNzrPQ4'\n};\n"))),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("p",{parentName:"li"},"Save the file and you should see a list with the cakes in your database on the right."),(0,i.kt)("img",{alt:"StackBlitz with the editor on the left and the application on the right",src:(0,r.Z)("/img/chapter-2-app-services/stackblitz-application.png"),width:"500"}))),(0,i.kt)("p",null,"The application uses the Atlas GraphQL API to access data from your Atlas database. Explore it by clicking on one of the cakes to open its details page. Add your comment about the cake. In the following section, we'll use the Google Cloud Natural Language API to analyze the sentiment of new comments. Make sure you keep the StackBlitz tab open in your browser!"))}u.isMDXComponent=!0}}]);